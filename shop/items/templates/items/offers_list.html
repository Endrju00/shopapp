{% extends 'items/base_list.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block items %}
  <div class="items">
    {% if sales %}
      {% for sale in page_obj %}
        <a href="{% url 'items:detail' sale.id %}" class="list-group-item list-group-item-action offer">
          <p style="float: left;">
            <img src="{{ sale.first_image.url }}" class="img-thumbnail" style="width: 250px; height: 250px; margin-right: 10px; object-fit: cover;">
          </p>
          <h1>{{ sale.title }}</h1>
          <p><small class="text-muted">
            Producer: <strong>{{ sale.item.producer }}</strong>
            <span class="characteristic">Condition: <strong>{{ sale.item.get_condition }}</strong></span>
            <span class="characteristic">Number of pieces in the package: <strong>{{ sale.quantity }}</strong></span>
          </small></p>

          <h2>{{ sale.price }}z≈Ç</h2>

          <form method="post" enctype='multipart/form-data' style="margin-bottom: 0px;">
            {% csrf_token %}
            {{ form|crispy }}
            <button class="btn btn-warning" type="submit" name="buy" value={{sale.id}}><span class="fa fa-dollar"></span> Buy Now!</button><br><br>
          </form>

          {% if sale.free_delivery %}
            <small class="text-muted">
              Free delivery available!
            </small>
            <p><small class="text-muted">
              Available till: <strong>{{ sale.exp_date }}</strong>
            </small></p>
          {% else %}
            <p style="margin-top:25px;"><small class="text-muted">
              Available till: <strong>{{ sale.exp_date }}</strong>
            </small></p>
          {% endif %}
        </a>
      {% endfor %}

      <div class="pagination" style="width: 100%;">
        <span class="step-links" style="margin-left: auto; margin-right: auto;">
            {% if page_obj.has_previous %}
                <a href="?page=1" class="btn btn-outline-dark"><span class="fa fa-backward"></span> First</a>
                <a href="?page={{ page_obj.previous_page_number }}" class="btn btn-outline-dark"><span class="fa fa-step-backward"></span> Previous</a>
            {% endif %}

            <span class="btn btn-warning">
                Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
            </span>

            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}" class="btn btn-outline-dark"><span class="fa fa-step-forward"></span> Next</a>
                <a href="?page={{ page_obj.paginator.num_pages }}" class="btn btn-outline-dark"><span class="fa fa-forward"></span> Last</a>
            {% endif %}
        </span>
      </div><br>

    {% else %}
      <h3>No sales are available.</h3>
    {% endif %}
  </div>
{% endblock %}
